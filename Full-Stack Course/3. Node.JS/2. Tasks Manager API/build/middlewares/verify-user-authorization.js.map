{"version":3,"sources":["../../src/middlewares/verify-user-authorization.ts","../../src/utils/app-error.ts"],"sourcesContent":["import { Request, Response, NextFunction } from \"express\";\nimport { AppError } from \"@/utils/app-error\";\n\n\nexport function verifyUserAuthorization(role: string[]) {\n  return (request: Request, response: Response, next: NextFunction) => {\n    if (!request.user) {\n      throw new AppError(\"Unauthorized\", 401);\n    }\n\n    if (!role.includes(request.user.role)) {\n      throw new AppError(\"Unauthorized\", 401);\n    }\n\n    return next();\n  }\n}\n","export class AppError {\n  message: string;\n  statusCode: number;\n\n  constructor(message: string, statusCode: number = 400) {\n    this.message = message;\n    this.statusCode = statusCode;\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAO,IAAM,WAAN,MAAe;AAAA,EACpB;AAAA,EACA;AAAA,EAEA,YAAY,SAAiB,aAAqB,KAAK;AACrD,SAAK,UAAU;AACf,SAAK,aAAa;AAAA,EACpB;AACF;;;ADJO,SAAS,wBAAwB,MAAgB;AACtD,SAAO,CAAC,SAAkB,UAAoB,SAAuB;AACnE,QAAI,CAAC,QAAQ,MAAM;AACjB,YAAM,IAAI,SAAS,gBAAgB,GAAG;AAAA,IACxC;AAEA,QAAI,CAAC,KAAK,SAAS,QAAQ,KAAK,IAAI,GAAG;AACrC,YAAM,IAAI,SAAS,gBAAgB,GAAG;AAAA,IACxC;AAEA,WAAO,KAAK;AAAA,EACd;AACF;","names":[]}